auto_corr_gumbel_adapt_med <- apply(auto_corr_gumbel_adapt,1,median)
auto_corr_gumbel_adapt_q025 <- apply(auto_corr_gumbel_adapt,1,\(x)quantile(x, .025))
auto_corr_gumbel_adapt_q975 <- apply(auto_corr_gumbel_adapt,1,\(x)quantile(x, .975))
ggplot() +
geom_line(aes(x = seq(0,400,10), y = auto_corr_gumbel_med), col = "red") +
geom_line(aes(x = seq(0,400,10), y = auto_corr_gumbel_adapt_med), col = "green")+
geom_ribbon(aes(x = seq(0,400,10), ymin = auto_corr_gumbel_q025, ymax = auto_corr_gumbel_q975), fill = "red", alpha = 0.2)+
geom_ribbon(aes(x = seq(0,400,10), ymin = auto_corr_gumbel_adapt_q025, ymax = auto_corr_gumbel_adapt_q975), fill = "green", alpha = 0.2)
auto_corr_gauss_med <- apply(auto_corr_gauss,1,median)
auto_corr_gauss_q025 <- apply(auto_corr_gauss,1,\(x)quantile(x, .025))
auto_corr_gauss_q975 <- apply(auto_corr_gauss,1,\(x)quantile(x, .975))
auto_corr_gauss_adapt_med <- apply(auto_corr_gauss_adapt,1,median)
auto_corr_gauss_adapt_q025 <- apply(auto_corr_gauss_adapt,1,\(x)quantile(x, .025))
auto_corr_gauss_adapt_q975 <- apply(auto_corr_gauss_adapt,1,\(x)quantile(x, .975))
ggplot() +
geom_line(aes(x = seq(0,400,10), y = auto_corr_gauss_med), col = "red") +
geom_line(aes(x = seq(0,400,10), y = auto_corr_gauss_adapt_med), col = "green")+
geom_ribbon(aes(x = seq(0,400,10), ymin = auto_corr_gauss_q025, ymax = auto_corr_gauss_q975), fill = "red", alpha = 0.2)+
geom_ribbon(aes(x = seq(0,400,10), ymin = auto_corr_gauss_adapt_q025, ymax = auto_corr_gauss_adapt_q975), fill = "green", alpha = 0.2)
auto_corr_t_med <- apply(auto_corr_t,1,median)
auto_corr_t_q025 <- apply(auto_corr_t,1,\(x)quantile(x, .025))
auto_corr_t_q975 <- apply(auto_corr_t,1,\(x)quantile(x, .975))
auto_corr_t_adapt_med <- apply(auto_corr_t_adapt,1,median)
auto_corr_t_adapt_q025 <- apply(auto_corr_t_adapt,1,\(x)quantile(x, .025))
auto_corr_t_adapt_q975 <- apply(auto_corr_t_adapt,1,\(x)quantile(x, .975))
ggplot() +
geom_line(aes(x = seq(0,400,10), y = auto_corr_t_med), col = "red") +
geom_line(aes(x = seq(0,400,10), y = auto_corr_t_adapt_med), col = "green")+
geom_ribbon(aes(x = seq(0,400,10), ymin = auto_corr_t_q025, ymax = auto_corr_t_q975), fill = "red", alpha = 0.2)+
geom_ribbon(aes(x = seq(0,400,10), ymin = auto_corr_t_adapt_q025, ymax = auto_corr_t_adapt_q975), fill = "green", alpha = 0.2)
auto_corr_frank_med <- apply(auto_corr_frank,1,median)
auto_corr_frank_q025 <- apply(auto_corr_frank,1,\(x)quantile(x, .025))
auto_corr_frank_q975 <- apply(auto_corr_frank,1,\(x)quantile(x, .975))
auto_corr_frank_adapt_med <- apply(auto_corr_frank_adapt,1,median)
auto_corr_frank_adapt_q025 <- apply(auto_corr_frank_adapt,1,\(x)quantile(x, .025))
auto_corr_frank_adapt_q975 <- apply(auto_corr_frank_adapt,1,\(x)quantile(x, .975))
ggplot() +
geom_line(aes(x = seq(0,400,10), y = auto_corr_frank_med), col = "red") +
geom_line(aes(x = seq(0,400,10), y = auto_corr_frank_adapt_med), col = "green")+
geom_ribbon(aes(x = seq(0,400,10), ymin = auto_corr_frank_q025, ymax = auto_corr_frank_q975), fill = "red", alpha = 0.2)+
geom_ribbon(aes(x = seq(0,400,10), ymin = auto_corr_frank_adapt_q025, ymax = auto_corr_frank_adapt_q975), fill = "green", alpha = 0.2)
?BiCopPar2Tau
# packages
library(VineCopula)
library(dplyr)
library(ggplot2)
library(patchwork)
################################################################################
# data generation
################################################################################
set.seed(1e3)
n <- 200
R <- 100
X_obs <- lapply(1:R, function(x)matrix(runif(n), ncol = 1))
# normalise predictors
data_norm <- function(X_obs){
X_obs.norm <- as.data.frame(apply(X_obs, 2, \(x) (x - min(x))/(max(x) - min(x))))
X_obs.norm <- as.matrix(X_obs.norm)
rownames(X_obs.norm) <- 1:nrow(X_obs)
return(X_obs.norm)
}
X_obs.norm <- lapply(1:R, function(i)data_norm(X_obs[[i]]))
# tau with tree structure
tree_tau_func <- function(X_obs){
tau_true_1 <- rep(0,nrow(X_obs))
tau_true_1[X_obs<0.33] <- 0.3
tau_true_1[(X_obs>=0.33)&(X_obs<0.66)] <- 0.8
tau_true_1[(X_obs>=0.66)] <- 0.3
tau_true_1 <- matrix(tau_true_1, ncol = 1)
}
tau_true_1 <- lapply(1:R, function(i){tree_tau_func(X_obs[[i]])})
# periodoic
tau_true_2 <- lapply(1:R, function(i){0.2*sin(2*pi*X_obs[[i]]) + 0.5})
plot(X_obs[[1]], tau_true_1[[1]], xlab = "Observations", ylab = "tau")
plot(X_obs[[1]], tau_true_2[[1]], xlab = "Observations", ylab = "tau")
# gauss # sin(tau*pi/2)
for (i in 1:2) {
assign(paste0("copula_uu_gauss_",i), lapply(1:R,function(k){BiCopSim(n, family = 1, par = sin(get(paste0("tau_true_",i))[[k]] * pi/2))}))
}
# t # sin(tau*pi/2)
for (i in 1:2) {
assign(paste0("copula_uu_t_",i), lapply(1:R, function(k){BiCopSim(n, family = 2, par = sin(get(paste0("tau_true_",i))[[k]] * pi/2), par2 = 3)}))
}
# gumbel # 1/(1-tau)
for (i in 1:2) {
assign(paste0("copula_uu_gumbel_",i), lapply(1:R, function(k){BiCopSim(n, family = 4, par = 1/(1-get(paste0("tau_true_",i))[[k]]))}))
}
# clayton # (2*tau)/(1-tau)
for (i in 1:2) {
assign(paste0("copula_uu_clayton_",i), lapply(1:R, function(k){BiCopSim(n, family = 3, par = (2*get(paste0("tau_true_",i))[[k]])/(1-get(paste0("tau_true_",i))[[k]]))}))
}
# frank # numerical
for (i in 1:2) {
assign(paste0("copula_uu_frank_",i), lapply(1:R, function(k){BiCopSim(n, family = 5, par = BiCopTau2Par(5, get(paste0("tau_true_",i))[[k]]))}))
}
# mcmc params
n.chain_par <- 4
n.iter_par <- 3000
n.discard <- 1500
n.thin <- 1
incl.split_par <- TRUE
cont.unif_par <- TRUE
################################################################################
# source files
################################################################################
source('MCMC_BART_copula.R')
source('import_functions.R')
moves.prob_par <- c(0.1, 0.4, 0.25, 0.25)
lb.prior.def <- list(fun = joint.prior.new.tree, param = c(1.5618883, 0.6293944))
n.tree <- 1
test_case <- 1
data_pred <- function(pred_list, x_list, family = "gauss"){
pred_cond_mod <- list()
if(family == "gauss"){
for (i in c(1:length(x_list))) {
pred_cond <- data.frame("obs" = rep(x_list[[i]], each = (n.chain_par * n.iter_par)))
pred_cond$theta_true = rep((get(paste0("tau_true_",test_case))[[i]]), each = (n.chain_par * (n.iter_par)))
pred_cond$y = BiCopPar2Tau(1,link_gauss(as.vector(pred_list[[i]])))
pred_cond$chain = rep(rep(1:n.chain_par, each = n.iter_par),n)
pred_cond$idx = rep(rep(1:n.iter_par, n.chain_par),n)
pred_cond$set = rep(i, (n.iter_par*n.chain_par*n))
pred_cond_mod[[i]] = pred_cond %>%
filter(idx > n.discard) %>%
group_by(obs, chain, theta_true) %>%
summarise(theta_mean = mean(y), theta_q975 = quantile(y, .975), theta_q025 = quantile(y, .025))
}
} else if(family == "t"){
for (i in c(1:length(x_list))) {
pred_cond <- data.frame("obs" = rep(x_list[[i]], each = (n.chain_par * n.iter_par)))
pred_cond$theta_true = rep((get(paste0("tau_true_",test_case))[[i]]), each = (n.chain_par * (n.iter_par)))
pred_cond$y = BiCopPar2Tau(2,link_t(as.vector(pred_list[[i]])))
pred_cond$chain = rep(rep(1:n.chain_par, each = n.iter_par),n)
pred_cond$idx = rep(rep(1:n.iter_par, n.chain_par),n)
pred_cond$set = rep(i, (n.iter_par*n.chain_par*n))
pred_cond_mod[[i]] = pred_cond %>%
filter(idx > n.discard) %>%
group_by(obs, chain, theta_true) %>%
summarise(theta_mean = mean(y), theta_q975 = quantile(y, .975), theta_q025 = quantile(y, .025))
}
} else if(family == "clayton"){
for (i in c(1:length(x_list))) {
pred_cond <- data.frame("obs" = rep(x_list[[i]], each = (n.chain_par * n.iter_par)))
pred_cond$theta_true = rep((get(paste0("tau_true_",test_case))[[i]]), each = (n.chain_par * (n.iter_par)))
pred_cond$y = BiCopPar2Tau(3,link_clayton(as.vector(pred_list[[i]])))
pred_cond$chain = rep(rep(1:n.chain_par, each = n.iter_par),n)
pred_cond$idx = rep(rep(1:n.iter_par, n.chain_par),n)
pred_cond$set = rep(i, (n.iter_par*n.chain_par*n))
pred_cond_mod[[i]] = pred_cond %>%
filter(idx > n.discard) %>%
group_by(obs, chain, theta_true) %>%
summarise(theta_mean = mean(y), theta_q975 = quantile(y, .975), theta_q025 = quantile(y, .025))
}
} else if(family == "gumbel"){
for (i in c(1:length(x_list))) {
pred_cond <- data.frame("obs" = rep(x_list[[i]], each = (n.chain_par * n.iter_par)))
pred_cond$theta_true = rep((get(paste0("tau_true_",test_case))[[i]]), each = (n.chain_par * (n.iter_par)))
pred_cond$y = BiCopPar2Tau(4,link_gumbel(as.vector(pred_list[[i]])))
pred_cond$chain = rep(rep(1:n.chain_par, each = n.iter_par),n)
pred_cond$idx = rep(rep(1:n.iter_par, n.chain_par),n)
pred_cond$set = rep(i, (n.iter_par*n.chain_par*n))
pred_cond_mod[[i]] = pred_cond %>%
filter(idx > n.discard) %>%
group_by(obs, chain, theta_true) %>%
summarise(theta_mean = mean(y), theta_q975 = quantile(y, .975), theta_q025 = quantile(y, .025))
}
} else if(family == "frank"){
for (i in c(1:length(x_list))) {
pred_cond <- data.frame("obs" = rep(x_list[[i]], each = (n.chain_par * n.iter_par)))
pred_cond$theta_true = rep((get(paste0("tau_true_",test_case))[[i]]), each = (n.chain_par * (n.iter_par)))
pred_cond$y = BiCopPar2Tau(5,link_frank(as.vector(pred_list[[i]])))
pred_cond$chain = rep(rep(1:n.chain_par, each = n.iter_par),n)
pred_cond$idx = rep(rep(1:n.iter_par, n.chain_par),n)
pred_cond$set = rep(i, (n.iter_par*n.chain_par*n))
pred_cond_mod[[i]] = pred_cond %>%
filter(idx > n.discard) %>%
group_by(obs, chain, theta_true) %>%
summarise(theta_mean = mean(y), theta_q975 = quantile(y, .975), theta_q025 = quantile(y, .025))
}
}
return(pred_cond_mod)
}
load(paste0("mcmc_1/gauss_mcmc_",test_case,"_tree_",n.tree,"_dat", ".Rdata"))
load(paste0("mcmc_1/gauss_mcmc_",test_case,"_tree_",n.tree,"_dat_adapt", ".Rdata"))
gauss_theta <- gauss_dat_list$pred[[1]] %>%
group_by(obs, theta_true) %>%
summarise(mean = mean(theta_mean))
View(gauss_theta)
for (i in 1:R) {
gauss_theta[[i]] <- gauss_dat_list$pred[[i]] %>%
group_by(obs, theta_true) %>%
summarise(mean = mean(theta_mean))
}
for (i in 1:R) {
gauss_pred_cop[[i]] <- BiCopSim(n, gauss_theta[[i]]$mean)
}
for (i in 1:R) {
gauss_pred_cop[[i]] <- BiCopSim(n, par = gauss_theta[[i]]$mean, family = 1)
}
gauss_pred_cop <- list()
for (i in 1:R) {
gauss_pred_cop[[i]] <- BiCopSim(n, par = gauss_theta[[i]]$mean, family = 1)
}
library(cramer)
cram_gauss <- sapply(1:100, function(i){set.seed(i); cramer.test(copula_uu_gauss_1[[i]], gauss_pred_cop[[i]], replicates = 100, sim = "permutation")$p.value})
cram_gauss <- list()
cram_gauss <- list()
for (i in 1:R) {
cram_gauss[[i]] <- sapply(1:100, function(i){set.seed(i); cramer.test(copula_uu_gauss_1[[i]], gauss_pred_cop[[i]], replicates = 100, sim = "permutation")$p.value})
}
mean(lapply(cram_gauss, mean))
(lapply(cram_gauss, mean))
mean(unlist(lapply(cram_gauss, mean)))
gauss_theta_adapt <- list()
for (i in 1:R) {
gauss_theta_adapt[[i]] <- gauss_dat_list_adapt$pred[[i]] %>%
group_by(obs, theta_true) %>%
summarise(mean = mean(theta_mean))
}
gauss_pred_cop_adapt <- list()
for (i in 1:R) {
gauss_pred_cop_adapt[[i]] <- BiCopSim(n, par = gauss_theta_adapt[[i]]$mean, family = 1)
}
cram_gauss_adapt <- list()
for (i in 1:R) {
cram_gauss_adapt[[i]] <- sapply(1:100, function(i){set.seed(i); cramer.test(copula_uu_gauss_1[[i]], gauss_pred_cop_adapt[[i]], replicates = 100, sim = "permutation")$p.value})
}
mean(unlist(lapply(cram_gauss, mean)))
mean(unlist(lapply(cram_gauss_adapt, mean)))
median(unlist(lapply(cram_gauss, mean)))
median(unlist(lapply(cram_gauss_adapt, mean)))
lapply(cram_gauss, mean)
identical(gauss_pred_cop[[1]],gauss_pred_cop[[2]])
identical(gauss_pred_cop_adapt[[1]],gauss_pred_cop_adapt[[2]])
for (j in 1:R) {
cram_gauss[[j]] <- sapply(1:100, function(i){set.seed(i); cramer.test(get(paste0("copula_uu_gauss_",test_case))[[j]], gauss_pred_cop[[j]], replicates = 100, sim = "permutation")$p.value})
}
median(unlist(lapply(cram_gauss, mean)))
cram_gauss_adapt <- list()
for (j in 1:R) {
cram_gauss_adapt[[j]] <- sapply(1:100, function(i){set.seed(i); cramer.test(get(paste0("copula_uu_gauss_",test_case))[[j]], gauss_pred_cop_adapt[[j]], replicates = 100, sim = "permutation")$p.value})
}
median(unlist(lapply(cram_gauss_adapt, mean)))
mean(unlist(lapply(cram_gauss, mean)))
mean(unlist(lapply(cram_gauss_adapt, mean)))
mean(unlist(lapply(cram_gauss, mean)))
mean(unlist(lapply(cram_gauss_adapt, mean)))
library(fasano.franceschini.test)
ff_gauss <- list()
for (j in 1:R) {
ff_gauss[[j]] <- sapply(1:100, function(i){set.seed(i); fasano.franceschini.test(get(paste0("copula_uu_gauss_",test_case))[[j]], gauss_pred_cop[[j]], nPermute = 100, verbose = F)$p.value})
}
library(fasano.franceschini.test)
ff_gauss <- list()
for (j in 1:R) {
ff_gauss[[j]] <- sapply(1:100, function(i){set.seed(i); fasano.franceschini.test(get(paste0("copula_uu_gauss_",test_case))[[j]], gauss_pred_cop[[j]], nPermute = 100, verbose = F)$p.value})
}
mean(unlist(lapply(ff_gauss, mean)))
ff_gauss_adapt <- list()
for (j in 1:R) {
ff_gauss_adapt[[j]] <- sapply(1:100, function(i){set.seed(i); fasano.franceschini.test(get(paste0("copula_uu_gauss_",test_case))[[j]], gauss_pred_cop_adapt[[j]], nPermute = 100, verbose = F)$p.value})
}
mean(unlist(lapply(ff_gauss_adapt, mean)))
mean(unlist(lapply(ff_gauss_adapt, mean)))
mean(unlist(lapply(ff_gauss, mean)))
save(cram_gauss, cram_gauss_adapt, ff_gauss, ff_gauss_adapt, file = paste("gauss_gof",test_case,".Rdata"))
rm(gauss_dat_list,gauss_dat_list_adapt)
load("gauss_gof 1 .Rdata")
View(cram_gauss)
View(cram_gauss_adapt)
load(paste0("mcmc_1/gauss_mcmc_",test_case,"_tree_",n.tree,"_stat", ".Rdata"))
n.tree <- 1
test_case <- 1
load(paste0("mcmc_1/gauss_mcmc_",test_case,"_tree_",n.tree,"_stat", ".Rdata"))
load(paste0("mcmc_1/gauss_mcmc_",test_case,"_tree_",n.tree,"_stat_adapt", ".Rdata"))
load(paste0("mcmc_1/t_mcmc_",test_case,"_tree_",n.tree,"_stat", ".Rdata"))
load(paste0("mcmc_1/t_mcmc_",test_case,"_tree_",n.tree,"_stat_adapt", ".Rdata"))
load(paste0("mcmc_1/clayton_mcmc_",test_case,"_tree_",n.tree,"_stat", ".Rdata"))
load(paste0("mcmc_1/clayton_mcmc_",test_case,"_tree_",n.tree,"_stat_adapt", ".Rdata"))
load(paste0("mcmc_1/gumbel_mcmc_",test_case,"_tree_",n.tree,"_stat", ".Rdata"))
load(paste0("mcmc_1/gumbel_mcmc_",test_case,"_tree_",n.tree,"_stat_adapt", ".Rdata"))
load(paste0("mcmc_1/frank_mcmc_",test_case,"_tree_",n.tree,"_stat", "_new_prop.Rdata"))
load(paste0("mcmc_1/frank_mcmc_",test_case,"_tree_",n.tree,"_stat_adapt", "_new_prop.Rdata"))
summ_stat_tree <- rbind(c(as.vector(gauss_stat_list$tree),as.vector(gauss_stat_list_adapt$tree)),
c(as.vector(t_stat_list$tree),as.vector(t_stat_list_adapt$tree)),
c(as.vector(clayton_stat_list$tree),as.vector(clayton_stat_list_adapt$tree)),
c(as.vector(gumbel_stat_list$tree),as.vector(gumbel_stat_list_adapt$tree)),
c(as.vector(frank_stat_list$tree),as.vector(frank_stat_list_adapt$tree)))
View(summ_stat_tree)
xtable(rbind(summ_stat_tree[,c(1,4,2,5,3,6)],summ_stat_tree[,c(7,10,8,11,9,12)]), digits = 3)
library(xtable)
xtable(rbind(summ_stat_tree[,c(1,4,2,5,3,6)],summ_stat_tree[,c(7,10,8,11,9,12)]), digits = 3)
# packages
library(VineCopula)
library(dplyr)
library(ggplot2)
library(patchwork)
load(paste0("mcmc_1/frank_mcmc_",test_case,"_tree_",n.tree,"_plot", ".Rdata"))
load(paste0("mcmc_1/frank_mcmc_",test_case,"_tree_",n.tree,"_stat", ".Rdata"))
load(paste0("mcmc_1/frank_mcmc_",test_case,"_tree_",n.tree,"_plot_adapt", ".Rdata"))
load(paste0("mcmc_1/frank_mcmc_",test_case,"_tree_",n.tree,"_stat_adapt", ".Rdata"))
(frank_plot_list$like + labs(title="Frank (without adaption)") + ylim(25,100) + geom_hline(yintercept = frank_like_true, linetype = 2) + frank_plot_list_adapt$like + labs(title="Frank (with adaption)") + ylim(25,100) + geom_hline(yintercept = frank_like_true, linetype = 2)) /
(frank_plot_list$nterm + labs(title="Frank (without adaption)")+ geom_hline(yintercept = 3, linetype = 2)+ ylim(0, 5) + frank_plot_list_adapt$nterm + labs(title="Frank (with adaption)")+ geom_hline(yintercept = 3, linetype = 2)+ ylim(0, 5)) /
(frank_plot_list$depth + labs(title="Frank (without adaption)")+ geom_hline(yintercept = 2, linetype = 2)+ ylim(0, 4) + frank_plot_list_adapt$depth + labs(title="Frank (with adaption)")+ geom_hline(yintercept = 2, linetype = 2)+ ylim(0, 4))
frank_like_true <- 86.50401
(frank_plot_list$like + labs(title="Frank (without adaption)") + ylim(25,100) + geom_hline(yintercept = frank_like_true, linetype = 2) + frank_plot_list_adapt$like + labs(title="Frank (with adaption)") + ylim(25,100) + geom_hline(yintercept = frank_like_true, linetype = 2)) /
(frank_plot_list$nterm + labs(title="Frank (without adaption)")+ geom_hline(yintercept = 3, linetype = 2)+ ylim(0, 5) + frank_plot_list_adapt$nterm + labs(title="Frank (with adaption)")+ geom_hline(yintercept = 3, linetype = 2)+ ylim(0, 5)) /
(frank_plot_list$depth + labs(title="Frank (without adaption)")+ geom_hline(yintercept = 2, linetype = 2)+ ylim(0, 4) + frank_plot_list_adapt$depth + labs(title="Frank (with adaption)")+ geom_hline(yintercept = 2, linetype = 2)+ ylim(0, 4))
load(paste0("mcmc_1/frank_mcmc_",test_case,"_tree_",n.tree,"_plot_long", ".Rdata"))
load(paste0("mcmc_1/frank_mcmc_",test_case,"_tree_",n.tree,"_stat_long", ".Rdata"))
load(paste0("mcmc_1/frank_mcmc_",test_case,"_tree_",n.tree,"_plot_adapt_long", ".Rdata"))
load(paste0("mcmc_1/frank_mcmc_",test_case,"_tree_",n.tree,"_stat_adapt_long", ".Rdata"))
(frank_plot_list$like + labs(title="Frank (without adaption)") + ylim(25,100) + geom_hline(yintercept = frank_like_true, linetype = 2) + frank_plot_list_adapt$like + labs(title="Frank (with adaption)") + ylim(25,100) + geom_hline(yintercept = frank_like_true, linetype = 2)) /
(frank_plot_list$nterm + labs(title="Frank (without adaption)")+ geom_hline(yintercept = 3, linetype = 2)+ ylim(0, 5) + frank_plot_list_adapt$nterm + labs(title="Frank (with adaption)")+ geom_hline(yintercept = 3, linetype = 2)+ ylim(0, 5)) /
(frank_plot_list$depth + labs(title="Frank (without adaption)")+ geom_hline(yintercept = 2, linetype = 2)+ ylim(0, 4) + frank_plot_list_adapt$depth + labs(title="Frank (with adaption)")+ geom_hline(yintercept = 2, linetype = 2)+ ylim(0, 4))
frank_stat_list
xtable(matrix(cbind(frank_stat_list$pred,frank_stat_list_adapt$pred), nrow = 1), digits = 3)
xtable(matrix(c(sqrt(frank_stat_list$pred[1]),as.vector(frank_stat_list$pred[-1]),sqrt(frank_stat_list_adapt$pred[1]),as.vector(frank_stat_list_adapt$pred[-1])), nrow = 1), digits = 3)
rbind(frank_stat_list$tree,frank_stat_list$tree)
rbind(frank_stat_list$tree,frank_stat_list_adapt$tree)
summ_stat_tree <- rbind(c(as.vector(gauss_stat_list$tree),as.vector(gauss_stat_list_adapt$tree)),
c(as.vector(t_stat_list$tree),as.vector(t_stat_list_adapt$tree)),
c(as.vector(clayton_stat_list$tree),as.vector(clayton_stat_list_adapt$tree)),
c(as.vector(gumbel_stat_list$tree),as.vector(gumbel_stat_list_adapt$tree)),
c(as.vector(frank_stat_list$tree),as.vector(frank_stat_list_adapt$tree)))
xtable(rbind(summ_stat_tree[,c(1,4,2,5,3,6)],summ_stat_tree[,c(7,10,8,11,9,12)]), digits = 3)
# packages
library(dplyr)
library(readr)
set.seed(123)
# dataset
cia_wf_data <- read.csv("countries.csv")
View(cia_wf_data)
# packages
library(dplyr)
library(readr)
set.seed(123)
# dataset
cia_wf_data <- read.csv("countries.csv")
cia_wf_data <- cia_wf_data %>% dplyr::select(all_of(c("Country","People.and.Society..Life.expectancy.at.birth...male",
"People.and.Society..Life.expectancy.at.birth...female",
"People.and.Society..Literacy...male",
"People.and.Society..Literacy...female",
"Economy..Real.GDP..purchasing.power.parity.")))
# "Economy..Real.GDP.per.capita")))
colnames(cia_wf_data) <- c("Country",
"Life_expectancy_M",
"Life_expectancy_F",
"Liter_M",
"Liter_F",
"GDP_PPP")
index_bil <- (grepl("billion ", cia_wf_data$GDP_PPP, fixed = TRUE))
index_tril <- (grepl("trillion ", cia_wf_data$GDP_PPP, fixed = TRUE))
index_mil <- (grepl("million ", cia_wf_data$GDP_PPP, fixed = TRUE))
cia_wf_data = cia_wf_data %>%
mutate(across(-c(Country),.fns = parse_number))
cia_wf_data$GDP_PPP[index_bil] = 1000 * cia_wf_data$GDP_PPP[index_bil]
cia_wf_data$GDP_PPP[index_tril] = 1000000 * cia_wf_data$GDP_PPP[index_tril]
cia_wf_data <- na.omit(cia_wf_data)
hist(cia_wf_data$Life_expectancy_M)
hist(cia_wf_data$Life_expectancy_M, xlab = "Age", main = "Life expectancy of Males")
hist(cia_wf_data$Life_expectancy_F, xlab = "Age", main = "Life expectancy of Females")
par(mfrow = c(1,2))
hist(cia_wf_data$Life_expectancy_F, xlab = "Age", main = "Life expectancy of Females")
hist(cia_wf_data$Life_expectancy_M, xlab = "Age", main = "Life expectancy of Males")
plot(log(cia_wf_data$GDP_PPP),cia_wf_data$Liter_F)
plot(log(cia_wf_data$GDP_PPP),cia_wf_data$Liter_M)
plot(log(cia_wf_data$GDP_PPP),cia_wf_data$Life_expectancy_F)
plot(log(cia_wf_data$GDP_PPP),cia_wf_data$Life_expectancy_M)
plot(log(cia_wf_data$GDP_PPP),cia_wf_data$Life_expectancy_F, ylab = "F Life Expectancy", xlab = "log-GDP")
plot(log(cia_wf_data$GDP_PPP),cia_wf_data$Life_expectancy_M, ylab = "M Life Expectancy", xlab = "log-GDP")
source('MCMC_BART_copula.R')
source('import_functions.R')
View(acceptance.prob.list_copula)
View(transition.p.change)
View(get_prune_idx)
library(tmap) library(raster) library(dismo) library(rayshader) library(elevatr) library(rnaturalearth) library(mapedit) library(mapview) library(dplyr) library(tmaptools) library(cartogram) library(sf) library(rmapshaper) library(geojsonio) library(sp)
library(tmap)
install.packages("tmap")
install.packages("terra")
install.packages("tmap")
library(raster)
install.packages("dismo")
library(dismo)
library(rayshader)
install.packages("rayshader")
install.packages("elevatr")
install.packages("rnaturalearth")
install.packages("mapedit")
install.packages("mapview")
install.packages(cartogram)
install.packages("cartogram")
library(sf)
install.packages("rmapshaper")
install.packages("geojsonio")
install.packages("geojsonio")
install.packages("protolife")
install.packages("protolite")
install.packages("geojsonio")
library(sp)
library(tmap)
library(raster)
library(dismo)
library(rayshader)
library(elevatr)
library(rnaturalearth)
library(mapedit)
library(mapview)
library(dplyr)
library(tmaptools)
library(cartogram)
library(sf)
library(rmapshaper)
library(geojsonio)
library(sp)
countries<-ne_countries(scale = 110, type = "countries", continent = NULL, country = NULL, geounit = NULL, sovereignty = NULL, returnclass = c("sf"))
admin<-ne_states(country = NULL, geounit = NULL, iso_a2 = NULL, spdf = NULL, returnclass = c("sf")) mapview(countries)
admin<-ne_states(country = NULL, geounit = NULL, iso_a2 = NULL, spdf = NULL, returnclass = c("sf"))
admin<-ne_states(country = NULL, geounit = NULL, iso_a2 = NULL, returnclass = c("sf"))
admin<-ne_states(country = NULL, geounit = NULL, iso_a2 = NULL, returnclass = c("sf"))
install.packages("rnaturalearthhires")
devtools::install_github("ropensci/rnaturalearthhires")
install_rnaturalearthhires()
install.packages("devtools")
countries<-ne_countries(scale = 110, type = "countries", continent = NULL, country = NULL, geounit = NULL, sovereignty = NULL, returnclass = c("sf"))
admin<-ne_states(country = NULL, geounit = NULL, iso_a2 = NULL, returnclass = c("sf"))
mapview(countries)
UK <- admin %>% filter(name=="United Kingdom")
dor <- admin %>% filter(name=="Dorset")
mapview(UK) + mapview(dor)
UK <- countries %>% filter(name=="United Kingdom")
dor <- admin %>% filter(name=="Dorset")
mapview(UK) + mapview(dor)
dor <- admin %>% filter(name=="Scotland")
mapview(dor)
UK <- countries %>% filter(name=="Scotland")
mapview(UK)
dor <- admin %>% filter(name=="Scotland")
UK <- countries %>% filter(name=="United Kingdom")
mapview(UK)
source('MCMC_BART_copula.R')
source('import_functions.R')
View(prior.split.rule)
View(joint.prior.new.tree)
View(prior.split.rule)
View(generate_random_binary_tree_depth_free)
generate_random_binary_tree_depth_free(1)
get_tree_plot(generate_random_binary_tree_depth_free(1))
get_tree_plot(generate_random_binary_tree_depth_free(2))
View(joint.prior.new.tree)
View(joint.prior.new)
View(count.tree)
View(prior.split.rule)
View(prob.split)
BiCopPDF
# packages
library(dplyr)
library(readr)
set.seed(123)
# dataset
cia_wf_data <- read.csv("countries.csv")
cia_wf_data <- cia_wf_data %>% dplyr::select(all_of(c("Country","People.and.Society..Life.expectancy.at.birth...male",
"People.and.Society..Life.expectancy.at.birth...female",
"People.and.Society..Literacy...male",
"People.and.Society..Literacy...female",
"Economy..Real.GDP..purchasing.power.parity.")))
colnames(cia_wf_data) <- c("Country",
"Life_expectancy_M",
"Life_expectancy_F",
"Liter_M",
"Liter_F",
"GDP_PPP")
index_bil <- (grepl("billion ", cia_wf_data$GDP_PPP, fixed = TRUE))
index_tril <- (grepl("trillion ", cia_wf_data$GDP_PPP, fixed = TRUE))
index_mil <- (grepl("million ", cia_wf_data$GDP_PPP, fixed = TRUE))
cia_wf_data = cia_wf_data %>%
mutate(across(-c(Country),.fns = parse_number))
cia_wf_data$GDP_PPP[index_bil] = 1000 * cia_wf_data$GDP_PPP[index_bil]
cia_wf_data$GDP_PPP[index_tril] = 1000000 * cia_wf_data$GDP_PPP[index_tril]
cia_wf_data <- na.omit(cia_wf_data)
plot(log(cia_wf_data$GDP_PPP),cia_wf_data$Life_expectancy_M)
plot(log(cia_wf_data$GDP_PPP),cia_wf_data$Life_expectancy_F)
plot(log(cia_wf_data$GDP_PPP),cia_wf_data$Liter_M)
plot(log(cia_wf_data$GDP_PPP),cia_wf_data$Liter_F)
U1_LE = ecdf(cia_wf_data$Life_expectancy_F)(cia_wf_data$Life_expectancy_F)
U1_LE
range(U1_LE)
BiCopPDF(0,0,1,0,5)
BiCopPDF(1,1,1,0,5)
BiCopPDF(1,1,1,0.5)
BiCopPDF(1,1,1,0.99)
BiCopPDF(1,1,2,0.99)
BiCopPDF(1,1,2,0.99, 3)
BiCopPDF(1,1,2,0.9999, 3)
BiCopPDF(1,1,2,1, 3)
BiCopPDF(1,1,2,0.9, 3)
generate_random_binary_tree_depth_free(1)
generate_random_binary_tree_depth_free(2)
generate_random_binary_tree_depth_free(1,2)
generate_random_binary_tree_depth_nterm(1,2)
get_prune_idx(generate_random_binary_tree_depth_nterm(1,2))
generate_random_binary_tree_n_delta(2,1)
generate_random_binary_tree_n_delta(2,0)
get_prune_idx(generate_random_binary_tree_n_delta(2,0))
get_prune_idx(generate_random_binary_tree_depth_nterm(2,3))
generate_random_binary_tree_depth_nterm(1,2)
get_depth(generate_random_binary_tree_depth_nterm(1,2))
get_prune_idx(assign_node_idx(generate_random_binary_tree_depth_nterm(1,2)))
BiCopPDF(0.99,0.99,1,2,1, 3)
BiCopPDF(0.99,0.99,2,1, 3)
BiCopPDF(0.99,0.99,2,.9, 3)
BiCopPDF(1,1,2,.9, 3)
View(get_set_valid_split)
